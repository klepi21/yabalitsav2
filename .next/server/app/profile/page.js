(()=>{var e={};e.id=178,e.ids=[178],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},38058:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>p});var t=s(73137),a=s(54647),i=s(4183),l=s.n(i),n=s(71775),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(r,o);let c=t.AppPageRouteModule,p=["",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,70503)),"/Users/konstantinoslepidas/Desktop/football/app/profile/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,58022)),"/Users/konstantinoslepidas/Desktop/football/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,51918,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/konstantinoslepidas/Desktop/football/app/profile/page.tsx"],u="/profile/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new c({definition:{kind:a.x.APP_PAGE,page:"/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:p}})},4286:(e,r,s)=>{Promise.resolve().then(s.bind(s,73737))},73737:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>q});var t=s(60080),a=s(9885),i=s(66558),l=s(83894),n=s(19098),o=s(43334),c=s(68384),p=s(46701),d=s(49424),u=s(66698),m=s(70345),x=s(23161);let h=a.forwardRef(({className:e,...r},s)=>(0,t.jsxs)(m.fC,{ref:s,className:(0,x.cn)("relative flex w-full touch-none select-none items-center",e),...r,children:[t.jsx(m.fQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:t.jsx(m.e6,{className:"absolute h-full bg-primary"})}),t.jsx(m.bU,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));h.displayName=m.fC.displayName;var f=s(87502),g=s(97052),j=s(32293),b=s(33478),v=s(2091),y=s(92861),N=s.n(y),w=s(12932);let _=n.Ry({username:n.Z_().min(3,"Username must be at least 3 characters").max(20,"Username must be less than 20 characters").regex(/^[a-zA-Z0-9_]+$/,"Username can only contain letters, numbers and underscores"),phone_number:n.Z_().optional(),phone_public:n.O7().default(!1),speed:n.Rx().min(1).max(5),pace:n.Rx().min(1).max(5),power:n.Rx().min(1).max(5)});function q(){let[e,r]=(0,a.useState)(!0),[s,n]=(0,a.useState)(null),[m,x]=(0,a.useState)(null),[y,q]=(0,a.useState)(null),P=(0,o.createClientComponentClient)(),{toast:k}=(0,f.pm)(),{t:C}=(0,w.useLanguage)(),E=(0,i.cI)({resolver:(0,l.F)(_),defaultValues:{username:"",phone_number:"",phone_public:!1,speed:3,pace:3,power:3}}),S=(E.watch("speed")+E.watch("pace")+E.watch("power"))/3;(0,a.useEffect)(()=>{let e=async()=>{try{let{data:{user:e}}=await P.auth.getUser();if(!e)return;let{data:r}=await P.from("profiles").select("*").eq("id",e.id).single(),{data:s}=await P.from("match_ratings").select("rating").eq("rated_player_id",e.id);if(r&&(n(r),E.reset({username:r.username||"",phone_number:r.phone_number||"",phone_public:r.phone_public||!1,speed:r.speed||3,pace:r.pace||3,power:r.power||3}),s&&s.length>0)){let e=s.reduce((e,r)=>e+r.rating,0)/s.length;q(Number(e.toFixed(1)))}}catch(e){console.error("Error fetching profile:",e)}finally{r(!1)}};e()},[]);let U=async e=>{try{let{data:{user:r}}=await P.auth.getUser();if(!r)return;let t=e.name.split(".").pop()?.toLowerCase();if(!t||!["jpg","jpeg","png","gif"].includes(t))throw Error("Invalid file type. Please upload a JPG, PNG, or GIF image.");let a=await N()(e,{maxSizeMB:1,maxWidthOrHeight:800,useWebWorker:!0}),i=`${r.id}.${t}`;await P.storage.from("avatars").remove([i]);let{error:l}=await P.storage.from("avatars").upload(i,a,{upsert:!0,contentType:`image/${t}`});if(l)throw l;let{data:{publicUrl:o}}=P.storage.from("avatars").getPublicUrl(i);await P.from("profiles").update({avatar_url:o}).eq("id",r.id),n({...s,avatar_url:o}),k({title:"Success",description:"Profile picture updated"})}catch(e){console.error("Error uploading avatar:",e),k({title:"Error",description:e instanceof Error?e.message:"Failed to upload profile picture",variant:"destructive"})}},I=async e=>{try{let{data:{user:r}}=await P.auth.getUser();if(!r)return;let{data:s,error:t}=await P.from("profiles").select("id").eq("username",e.username).neq("id",r.id);if(t)throw t;if(s&&s.length>0){E.setError("username",{type:"manual",message:"Username is already taken"});return}let{error:a}=await P.from("profiles").update({username:e.username,phone_number:e.phone_number,phone_public:e.phone_public,speed:e.speed,pace:e.pace,power:e.power}).eq("id",r.id);if(a)throw a;k({title:"Success",description:"Profile updated successfully"})}catch(e){console.error("Error updating profile:",e),k({title:"Error",description:"Failed to update profile",variant:"destructive"})}};return e?t.jsx("div",{className:"p-4",children:"Loading..."}):t.jsx("div",{className:"p-4 space-y-6",children:(0,t.jsxs)(g.Zb,{children:[t.jsx(g.Ol,{children:t.jsx(g.ll,{children:C("profile.title")})}),(0,t.jsxs)(g.aY,{className:"space-y-6",children:[t.jsx("div",{className:"flex flex-col items-center",children:(0,t.jsxs)("div",{className:"relative group cursor-pointer",children:[(0,t.jsxs)(j.qE,{className:"h-24 w-24",children:[t.jsx(j.F$,{src:s?.avatar_url}),t.jsx(j.Q5,{children:s?.full_name?.[0]||"?"})]}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity",children:t.jsx("label",{htmlFor:"avatar-upload",className:"text-xs text-white cursor-pointer",children:C("profile.changePhoto")})}),t.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",className:"hidden",onChange:e=>{let r=e.target.files?.[0];r&&U(r)}})]})}),(0,t.jsxs)("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-sm font-medium",children:C("profile.fullName")}),t.jsx("p",{className:"text-sm text-muted-foreground",children:s?.full_name||C("profile.notSet")})]}),t.jsx(p.l0,{...E,children:(0,t.jsxs)("form",{onSubmit:E.handleSubmit(I),className:"space-y-4",children:[t.jsx(p.Wi,{control:E.control,name:"username",render:({field:e})=>(0,t.jsxs)(p.xJ,{children:[t.jsx(p.lX,{children:C("profile.username")}),t.jsx(p.NI,{children:t.jsx(d.I,{placeholder:"Enter username",...e})}),t.jsx(p.zG,{})]})}),t.jsx(p.Wi,{control:E.control,name:"phone_number",render:({field:e})=>(0,t.jsxs)(p.xJ,{children:[t.jsx(p.lX,{children:C("profile.phoneNumber.label")}),t.jsx(p.NI,{children:t.jsx(d.I,{placeholder:C("profile.phoneNumber.placeholder"),...e})}),t.jsx(p.zG,{})]})}),t.jsx(p.Wi,{control:E.control,name:"phone_public",render:({field:e})=>(0,t.jsxs)(p.xJ,{className:"flex items-center justify-between rounded-lg border p-4",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[t.jsx(p.lX,{className:"text-base",children:C("profile.sharePhone")}),t.jsx(p.pf,{children:C("profile.sharePhoneDesc")})]}),t.jsx(p.NI,{children:t.jsx(u.r,{checked:e.value,onCheckedChange:e.onChange})})]})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(b._,{children:C("profile.ratings.speed.value").replace("{value}",E.watch("speed").toString())}),t.jsx(p.Wi,{control:E.control,name:"speed",render:({field:e})=>t.jsx(p.xJ,{children:t.jsx(p.NI,{children:t.jsx(h,{min:1,max:5,step:1,value:[e.value],onValueChange:([r])=>e.onChange(r)})})})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(b._,{children:C("profile.ratings.pace.value").replace("{value}",E.watch("pace").toString())}),t.jsx(p.Wi,{control:E.control,name:"pace",render:({field:e})=>t.jsx(p.xJ,{children:t.jsx(p.NI,{children:t.jsx(h,{min:1,max:5,step:1,value:[e.value],onValueChange:([r])=>e.onChange(r)})})})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(b._,{children:C("profile.ratings.power.value").replace("{value}",E.watch("power").toString())}),t.jsx(p.Wi,{control:E.control,name:"power",render:({field:e})=>t.jsx(p.xJ,{children:t.jsx(p.NI,{children:t.jsx(h,{min:1,max:5,step:1,value:[e.value],onValueChange:([r])=>e.onChange(r)})})})})]}),(0,t.jsxs)("div",{className:"pt-2 border-t",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[t.jsx("p",{className:"font-medium",children:C("profile.selfRating")}),t.jsx("p",{className:"text-lg font-semibold",children:S.toFixed(1)})]}),y?(0,t.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[t.jsx("p",{className:"font-medium",children:C("profile.communityRating")}),(0,t.jsxs)("div",{className:"text-right",children:[t.jsx(v.Z,{rating:y}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:C("profile.basedOnFeedback")})]})]}):(0,t.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[t.jsx("p",{className:"font-medium",children:C("profile.communityRating")}),t.jsx("p",{className:"text-sm text-muted-foreground",children:C("profile.noRatingsYet")})]})]})]}),t.jsx(c.z,{type:"submit",className:"w-full",children:C("profile.updateProfile")})]})})]})]})})}},70503:(e,r,s)=>{"use strict";s.r(r),s.d(r,{$$typeof:()=>l,__esModule:()=>i,default:()=>o});var t=s(17536);let a=(0,t.createProxy)(String.raw`/Users/konstantinoslepidas/Desktop/football/app/profile/page.tsx`),{__esModule:i,$$typeof:l}=a,n=a.default,o=n}};var r=require("../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[650,125,129,418,398,617,52,293,976,91],()=>s(38058));module.exports=t})();