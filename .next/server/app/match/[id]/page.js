(()=>{var e={};e.id=733,e.ids=[733],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},63961:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>m,routeModule:()=>h,tree:()=>d});var r=s(73137),a=s(54647),i=s(4183),l=s.n(i),n=s(71775),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);s.d(t,c);let o=r.AppPageRouteModule,d=["",{children:["match",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,51755)),"/Users/konstantinoslepidas/Desktop/football/app/match/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,58022)),"/Users/konstantinoslepidas/Desktop/football/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,51918,23)),"next/dist/client/components/not-found-error"]}],m=["/Users/konstantinoslepidas/Desktop/football/app/match/[id]/page.tsx"],p="/match/[id]/page",u={require:s,loadChunk:()=>Promise.resolve()},h=new o({definition:{kind:a.x.APP_PAGE,page:"/match/[id]/page",pathname:"/match/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},66100:(e,t,s)=>{Promise.resolve().then(s.bind(s,74536))},74536:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>S});var r=s(60080),a=s(9885),i=s(79862),l=s(43334),n=s(91672),c=s(15441),o=s(87094),d=s(14571),m=s(56388),p=s(66386),u=s(38011),h=s(97052),x=s(24796),f=s(68384),g=s(32293),j=s(87502),y=s(23764),v=s(7073),w=s(49424),N=s(57114),_=s(67932);function b({matchId:e,playerId:t,playerName:s,existingRating:i,onRated:n}){let[c,o]=(0,a.useState)(i||0),[d,m]=(0,a.useState)(0),[p,u]=(0,a.useState)(!1),h=(0,l.createClientComponentClient)(),{toast:x}=(0,j.pm)(),g=async()=>{try{u(!0);let{data:{user:s}}=await h.auth.getUser();if(!s)return;let{error:r}=await h.from("match_ratings").upsert({match_id:e,rated_player_id:t,rater_id:s.id,rating:c});if(r)throw r;x({title:"Success",description:"Rating submitted successfully"}),n?.()}catch(e){console.error("Error submitting rating:",e),x({title:"Error",description:"Failed to submit rating",variant:"destructive"})}finally{u(!1)}};return(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg border",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium",children:s}),r.jsx("div",{className:"flex gap-1 mt-1",children:[1,2,3,4,5].map(e=>r.jsx("button",{className:"focus:outline-none",onMouseEnter:()=>m(e),onMouseLeave:()=>m(0),onClick:()=>o(e),children:r.jsx(_.Z,{className:`h-6 w-6 ${e<=(d||c)?"fill-primary text-primary":"text-muted-foreground"}`})},e))})]}),r.jsx(f.z,{size:"sm",disabled:!c||p,onClick:g,children:p?"Submitting...":"Submit"})]})}var k=s(2091);function C({className:e=""}){return r.jsx("div",{className:`relative w-full h-48 bg-gradient-to-b from-primary/20 to-background overflow-hidden ${e}`,children:(0,r.jsxs)("svg",{className:"absolute inset-0 w-full h-full opacity-[0.15]",viewBox:"0 0 800 400",xmlns:"http://www.w3.org/2000/svg",children:[r.jsx("rect",{x:"20",y:"20",width:"760",height:"360",stroke:"currentColor",fill:"none",strokeWidth:"2"}),r.jsx("circle",{cx:"400",cy:"200",r:"70",stroke:"currentColor",fill:"none",strokeWidth:"2"}),r.jsx("line",{x1:"400",y1:"20",x2:"400",y2:"380",stroke:"currentColor",strokeWidth:"2"}),r.jsx("rect",{x:"20",y:"120",width:"100",height:"160",stroke:"currentColor",fill:"none",strokeWidth:"2"}),r.jsx("rect",{x:"20",y:"160",width:"50",height:"80",stroke:"currentColor",fill:"none",strokeWidth:"2"}),r.jsx("circle",{cx:"120",cy:"200",r:"2",fill:"currentColor"}),r.jsx("rect",{x:"680",y:"120",width:"100",height:"160",stroke:"currentColor",fill:"none",strokeWidth:"2"}),r.jsx("rect",{x:"730",y:"160",width:"50",height:"80",stroke:"currentColor",fill:"none",strokeWidth:"2"}),r.jsx("circle",{cx:"680",cy:"200",r:"2",fill:"currentColor"}),r.jsx("path",{d:"M20,40 A20,20 0 0,1 40,20",stroke:"currentColor",fill:"none",strokeWidth:"2"}),r.jsx("path",{d:"M760,40 A20,20 0 0,0 780,20",stroke:"currentColor",fill:"none",strokeWidth:"2"}),r.jsx("path",{d:"M20,360 A20,20 0 0,0 40,380",stroke:"currentColor",fill:"none",strokeWidth:"2"}),r.jsx("path",{d:"M760,360 A20,20 0 0,1 780,380",stroke:"currentColor",fill:"none",strokeWidth:"2"})]})})}var q=s(12932),E=s(81149);function S({params:e}){let[t,s]=(0,a.useState)(null),[_,S]=(0,a.useState)(!0),[P,M]=(0,a.useState)(!1),[z,Z]=(0,a.useState)(!1),[F,W]=(0,a.useState)(""),[A,U]=(0,a.useState)(!1),[$,R]=(0,a.useState)(!1),D=(0,l.createClientComponentClient)(),{toast:I}=(0,j.pm)(),Y=(0,N.useRouter)(),[G,H]=(0,a.useState)(null),[L,T]=(0,a.useState)({}),{t:J}=(0,q.useLanguage)();(0,a.useEffect)(()=>{let e=async()=>{let{data:{user:e}}=await D.auth.getUser();H(e)};e()},[]);let O=async()=>{try{let{data:{user:t}}=await D.auth.getUser();if(!t)return;let{data:r,error:a}=await D.from("matches").select(`
          *,
          venue:venues(*),
          host:profiles!matches_host_id_fkey(*),
          participants:match_participants(
            player:profiles(*)
          ),
          match_ratings(*)
        `).eq("id",e.id).single();if(a)throw a;s(r),Z(r.host_id===t.id),M(r.participants.some(e=>e.player.id===t.id));let i=r.participants.map(e=>e.player.id),{data:l}=await D.from("match_ratings").select("rating, rated_player_id").in("rated_player_id",i),n={};l?.forEach(e=>{n[e.rated_player_id]||(n[e.rated_player_id]=[]),n[e.rated_player_id].push(e.rating)});let c={};Object.entries(n).forEach(([e,t])=>{let s=t.reduce((e,t)=>e+t,0)/t.length;c[e]=Number(s.toFixed(1))}),T(c)}catch(e){console.error("Error fetching match:",e)}finally{S(!1)}};(0,a.useEffect)(()=>{G&&O()},[e.id,G]);let B=async()=>{try{let{data:{user:r}}=await D.auth.getUser();if(!r)return;let a=new Date(t.match_date),i=(0,y.Z)(a,-8),l=new Date;if(!(0,v.Z)(l,i)){I({title:"Cannot Cancel",description:"Cancellations are only allowed up to 8 hours before the match",variant:"destructive"});return}let{error:n}=await D.from("match_participants").delete().match({match_id:t.id,player_id:r.id});if(n)throw n;M(!1),I({title:"Success",description:"You've cancelled your participation"});let{data:c,error:o}=await D.from("matches").select(`
          *,
          venue:venues(*),
          host:profiles!matches_host_id_fkey(*),
          participants:match_participants(
            player:profiles(
              id,
              full_name,
              phone_number,
              phone_public,
              avatar_url
            )
          )
        `).eq("id",e.id).single();if(o)throw o;s(c)}catch(e){console.error("Error cancelling participation:",e),I({title:"Error",description:"Failed to cancel participation",variant:"destructive"})}},Q=async()=>{try{if(t.private_code!==F){I({title:"Invalid Code",description:"The code you entered is incorrect",variant:"destructive"});return}let{data:{user:e}}=await D.auth.getUser();if(!e)return;let{error:s}=await D.from("match_participants").insert({match_id:t.id,player_id:e.id});if(s)throw s;M(!0),U(!1),I({title:"Success",description:"You've joined the match!"})}catch(e){console.error("Error joining match:",e),I({title:"Error",description:"Failed to join match",variant:"destructive"})}},V=async()=>{try{let e=window.confirm("Are you sure you want to delete this match? This action cannot be undone.");if(!e)return;let{error:s}=await D.from("match_participants").delete().eq("match_id",t.id);if(s)throw s;let{error:r}=await D.from("matches").delete().eq("id",t.id);if(r)throw r;I({title:"Success",description:"Match has been deleted"}),Y.push("/")}catch(e){console.error("Error deleting match:",e),I({title:"Error",description:"Failed to delete match",variant:"destructive"})}},X=async()=>{try{let e=window.confirm("Are you sure you want to mark this match as finished?");if(!e)return;let{error:s}=await D.from("matches").update({status:"finished"}).eq("id",t.id);if(s)throw s;I({title:"Success",description:"Match has been marked as finished"}),await O()}catch(e){console.error("Error finishing match:",e),I({title:"Error",description:"Failed to finish match",variant:"destructive"})}},K=async e=>{try{return await navigator.clipboard.writeText(e),!0}catch(e){return console.error("Failed to copy text: ",e),!1}},ee=async()=>{try{let{data:{user:e}}=await D.auth.getUser();if(!e)return;let{error:s}=await D.from("match_participants").insert({match_id:t.id,player_id:e.id});if(s)throw s;I({title:"Success",description:"You've joined the match!"}),O()}catch(e){console.error("Error joining match:",e),I({title:"Error",description:"Failed to join match",variant:"destructive"})}};if(_)return r.jsx("div",{className:"p-4",children:"Loading..."});if(!t)return r.jsx("div",{className:"p-4",children:"Match not found"});let et=new Date(t.match_date),es=(0,E.x)(et,"EEEE d MMM"),er=(0,i.ZP)(et,"HH:mm"),ea=t.participants?.length||0,ei=(0,y.Z)(et,-8),el=(0,v.Z)(new Date,ei),en=e=>{let[t,...s]=e.split(" ");return`${t} ${s.map(e=>e[0]).join(". ")}.`};return r.jsx("div",{className:"p-4 space-y-6",children:(0,r.jsxs)(h.Zb,{className:"border-none shadow-none",children:[r.jsx(C,{className:"rounded-t-lg"}),(0,r.jsxs)(h.Ol,{className:"flex flex-row items-center justify-between pb-2 px-4 -mt-8 relative z-10",children:[(0,r.jsxs)("div",{className:"bg-background p-4 rounded-lg shadow-lg",children:[r.jsx("h1",{className:"text-2xl font-bold",children:t.venue.name}),(0,r.jsxs)("p",{className:"text-muted-foreground flex items-center gap-2",children:[r.jsx(n.Z,{className:"h-4 w-4"}),J("matches.host")," ",t.host.full_name]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-end gap-2 bg-background p-4 rounded-lg shadow-lg",children:[t.is_private&&r.jsx(x.C,{variant:"secondary",children:J("matches.private")}),r.jsx(x.C,{variant:"outline",children:J(`matches.status.${t.status}`)})]})]}),(0,r.jsxs)(h.aY,{className:"space-y-8 px-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"p-4 rounded-lg border space-y-1",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:J("matches.date")}),(0,r.jsxs)("p",{className:"font-medium flex items-center gap-2",children:[r.jsx(c.Z,{className:"h-4 w-4"}),es]})]}),(0,r.jsxs)("div",{className:"p-4 rounded-lg border space-y-1",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:J("matches.time")}),(0,r.jsxs)("p",{className:"font-medium flex items-center gap-2",children:[r.jsx(c.Z,{className:"h-4 w-4"}),er]})]}),(0,r.jsxs)("div",{className:"p-4 rounded-lg border space-y-1",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:J("matches.details.costPerPlayer")}),(0,r.jsxs)("p",{className:"font-medium flex items-center gap-2",children:[r.jsx(u.R,{className:"h-4 w-4"}),"€",t.cost_per_player]})]}),(0,r.jsxs)("div",{className:"p-4 rounded-lg border space-y-1",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:J("matches.players")}),(0,r.jsxs)("p",{className:"font-medium flex items-center gap-2",children:[r.jsx(n.Z,{className:"h-4 w-4"}),ea," / ",t.max_players]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("h2",{className:"text-xl font-semibold",children:J("matches.details.location")}),r.jsx("a",{href:`https://maps.google.com/?q=${t.venue.address}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:J("matches.details.openInMaps")})]}),r.jsx("div",{className:"p-4 rounded-lg border",children:(0,r.jsxs)("p",{className:"font-medium flex items-center gap-2",children:[r.jsx(o.Z,{className:"h-4 w-4"}),t.venue.address]})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Players"}),r.jsx("div",{className:"grid gap-3",children:t.participants.map(e=>{let s=e.player.speed&&e.player.pace&&e.player.power?((e.player.speed+e.player.pace+e.player.power)/3).toFixed(1):null,a=L[e.player.id];return r.jsx("div",{className:"flex items-center justify-between p-4 rounded-lg border",children:(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)(g.qE,{className:"h-10 w-10",children:[r.jsx(g.F$,{src:e.player.avatar_url}),r.jsx(g.Q5,{children:e.player.full_name[0]})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-medium",children:en(e.player.full_name)}),e.player.id===t.host_id&&r.jsx(x.C,{variant:"outline",children:"Host"})]}),(0,r.jsxs)("div",{className:"flex gap-3 items-center",children:[s&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Self:"}),r.jsx(x.C,{variant:"secondary",className:"text-xs",children:s})]}),a&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Community:"}),r.jsx(k.Z,{rating:a,size:"sm",showValue:!1})]})]}),z&&e.player.phone_public&&e.player.phone_number&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[r.jsx(d.Z,{className:"h-3 w-3"}),e.player.phone_number]})]})]})},e.player.id)})})]}),!z&&"finished"!==t.status&&(0,r.jsxs)(r.Fragment,{children:[!P&&ea<t.max_players&&r.jsx(r.Fragment,{children:t.is_private&&!A?r.jsx(f.z,{className:"w-full",onClick:()=>U(!0),children:J("matches.details.joinPrivate")}):t.is_private&&A?(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(w.I,{type:"text",placeholder:J("matches.details.enterCode"),maxLength:6,value:F,onChange:e=>W(e.target.value)}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(f.z,{className:"flex-1",onClick:Q,children:J("matches.details.submitCode")}),r.jsx(f.z,{variant:"outline",onClick:()=>{U(!1),W("")},children:"Cancel"})]})]}):r.jsx(f.z,{className:"w-full",onClick:ee,children:"Join Match"})}),P&&r.jsx(f.z,{variant:"destructive",className:"w-full",onClick:B,disabled:!el,children:J(el?"matches.details.cancelParticipation":"matches.details.cannotCancel")})]}),z&&"finished"!==t.status&&ea/t.max_players<.9&&(0,r.jsxs)("div",{className:"mt-6 pt-6 border-t",children:[r.jsx(f.z,{variant:"destructive",className:"w-full",onClick:V,children:J("matches.details.deleteMatch")}),r.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:J("matches.details.deleteWarning")})]}),z&&"upcoming"===t.status&&r.jsx(f.z,{className:"w-full mt-4",onClick:X,children:J("matches.details.markAsFinished")}),"finished"===t.status&&G&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Rate Players"}),r.jsx(f.z,{variant:"outline",onClick:()=>R(!$),children:$?"Hide Ratings":"Show Ratings"})]}),$&&r.jsx("div",{className:"space-y-3",children:t.participants.filter(e=>e.player.id!==G.id).map(e=>{let s=t.match_ratings?.find(t=>t.rater_id===G.id&&t.rated_player_id===e.player.id)?.rating;return r.jsx(b,{matchId:t.id,playerId:e.player.id,playerName:e.player.full_name,existingRating:s,onRated:O},e.player.id)})})]}),z&&t.is_private&&"finished"!==t.status&&(0,r.jsxs)("div",{className:"mt-2 p-4 bg-muted rounded-lg space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"text-sm font-medium",children:J("matches.details.privateCode")}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(f.z,{size:"sm",variant:"outline",className:"h-8",onClick:async()=>{let e=await K(t.private_code);e&&I({title:"Copied!",description:"Match code copied to clipboard"})},children:[r.jsx(m.Z,{className:"h-4 w-4 mr-1"}),J("matches.details.copyCode")]}),(0,r.jsxs)(f.z,{size:"sm",variant:"outline",className:"h-8",onClick:()=>{navigator.share?navigator.share({title:"Join my football match!",text:`Join my match at ${t.venue.name}! Use code: ${t.private_code}`,url:window.location.href}).catch(e=>{console.error("Error sharing:",e)}):I({title:"Sharing not supported",description:"Your browser doesn't support sharing",variant:"destructive"})},children:[r.jsx(p.Z,{className:"h-4 w-4 mr-1"}),J("matches.details.share")]})]})]}),r.jsx("p",{className:"text-lg font-mono tracking-wider text-center bg-background rounded p-2",children:t.private_code})]})]})]})})}},49424:(e,t,s)=>{"use strict";s.d(t,{I:()=>l});var r=s(60080),a=s(9885),i=s(23161);let l=a.forwardRef(({className:e,type:t,...s},a)=>r.jsx("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));l.displayName="Input"},51755:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>i,default:()=>c});var r=s(17536);let a=(0,r.createProxy)(String.raw`/Users/konstantinoslepidas/Desktop/football/app/match/[id]/page.tsx`),{__esModule:i,$$typeof:l}=a,n=a.default,c=n}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[650,234,862,843,287,489,92,52,148,358],()=>s(63961));module.exports=r})();