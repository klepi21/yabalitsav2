(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[572],{8010:function(e,a,t){Promise.resolve().then(t.bind(t,38))},38:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return U}});var r=t(7437),s=t(2265),n=t(4033),l=t(1865),i=t(8110),o=t(4578),c=t(3082),d=t(1315),m=t(1335),u=t(3523),p=t(9224),h=t(2442),x=t(9311);let f=m.fC;m.ZA;let g=m.B4,j=s.forwardRef((e,a)=>{let{className:t,children:s,...n}=e;return(0,r.jsxs)(m.xz,{ref:a,className:(0,x.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[s,(0,r.jsx)(m.JO,{asChild:!0,children:(0,r.jsx)(u.Z,{className:"h-4 w-4 opacity-50"})})]})});j.displayName=m.xz.displayName;let y=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(m.u_,{ref:a,className:(0,x.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(p.Z,{className:"h-4 w-4"})})});y.displayName=m.u_.displayName;let b=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(m.$G,{ref:a,className:(0,x.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(u.Z,{className:"h-4 w-4"})})});b.displayName=m.$G.displayName;let v=s.forwardRef((e,a)=>{let{className:t,children:s,position:n="popper",...l}=e;return(0,r.jsx)(m.h_,{children:(0,r.jsxs)(m.VY,{ref:a,className:(0,x.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...l,children:[(0,r.jsx)(y,{}),(0,r.jsx)(m.l_,{className:(0,x.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(b,{})]})})});v.displayName=m.VY.displayName;let _=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(m.__,{ref:a,className:(0,x.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s})});_.displayName=m.__.displayName;let w=s.forwardRef((e,a)=>{let{className:t,children:s,...n}=e;return(0,r.jsxs)(m.ck,{ref:a,className:(0,x.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(m.wU,{children:(0,r.jsx)(h.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(m.eT,{children:s})]})});w.displayName=m.ck.displayName;let N=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(m.Z0,{ref:a,className:(0,x.cn)("-mx-1 my-1 h-px bg-muted",t),...s})});N.displayName=m.Z0.displayName;var C=t(1908),k=t(3023),z=t(1291),R=t(7158),Z=t(548);function M(e){let{className:a,classNames:t,showOutsideDays:s=!0,...n}=e;return(0,r.jsx)(Z._W,{showOutsideDays:s,className:(0,x.cn)("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,x.cn)((0,k.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,x.cn)((0,k.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{...a}=e;return(0,r.jsx)(z.Z,{className:"h-4 w-4"})},IconRight:e=>{let{...a}=e;return(0,r.jsx)(R.Z,{className:"h-4 w-4"})}},...n})}M.displayName="Calendar";var S=t(8257),I=t(5050);let V=I.fC,O=I.xz,J=s.forwardRef((e,a)=>{let{className:t,align:s="center",sideOffset:n=4,...l}=e;return(0,r.jsx)(I.h_,{children:(0,r.jsx)(I.VY,{ref:a,align:s,sideOffset:n,className:(0,x.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})})});J.displayName=I.VY.displayName;var P=t(8203),W=t(9314),G=t(3775),E=t(8904),X=t(2621),q=t(6110),Y=t(6062);let L=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(Y.fC,{ref:a,className:(0,x.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:(0,r.jsx)(Y.z$,{className:(0,x.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(h.Z,{className:"h-4 w-4"})})})});function A(e){return(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("path",{d:"M12 2a10 10 0 0 1 8.66 5"}),(0,r.jsx)("path",{d:"M12 2a10 10 0 0 0-8.66 5"}),(0,r.jsx)("path",{d:"M12 22V2"}),(0,r.jsx)("path",{d:"M12 22a10 10 0 0 0 8.66-5"}),(0,r.jsx)("path",{d:"M12 22a10 10 0 0 1-8.66-5"}),(0,r.jsx)("path",{d:"M2 12h20"})]})}L.displayName=Y.fC.displayName;var D=t(9853);let T=async e=>{try{let a=new Date(e.match_date),t=(0,W.ZP)(a,"dd/MM/yyyy"),r=(0,W.ZP)(a,"HH:mm");await fetch("https://onesignal.com/api/v1/notifications",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic ".concat("os_v2_app_ykyfjt6btvexbgka7g3ay3i7w33dvmpis5tuvg4mfcuro5eamghod75fz6x5bmjwbeknzaso34daf5secmkyjgezkzloonovtqvnc3y")},body:JSON.stringify({app_id:"c2b054cf-c19d-4970-9940-f9b60c6d1fb6",included_segments:["Subscribed Users"],contents:{en:"New match at ".concat(e.venue.name," on ").concat(t," at ").concat(r)},headings:{en:"New Match Available!"},url:"".concat(window.location.origin,"/match/").concat(e.id),web_buttons:[{id:"join-match",text:"View Match",url:"".concat(window.location.origin,"/match/").concat(e.id)}]})})}catch(e){console.error("Error sending notification:",e)}};function U(){let e=(0,n.useRouter)();(0,c.createClientComponentClient)();let{toast:a}=(0,X.pm)(),[t,m]=(0,s.useState)(!1),{t:u}=(0,D.useLanguage)(),p=o.Ry({venue_id:o.Z_({required_error:u("create.errors.venueRequired")}),match_date:o.hT({required_error:u("create.errors.dateRequired")}).refine(e=>!(0,G.Z)(e,(0,E.Z)()),u("create.errors.dateInPast")),match_time:o.Z_().refine(e=>{let[a,t]=e.split(":").map(Number);return a>=10&&a<=23&&(0===t||30===t)},u("create.errors.timeInvalid")),max_players:o.Rx().min(10,u("create.errors.playersRange")).max(16,u("create.errors.playersRange")),cost_per_player:o.Rx().min(0,u("create.errors.costNegative")),is_private:o.O7().default(!1),venue_confirmed:o.O7().refine(e=>!0===e,{message:u("create.errors.venueConfirmRequired")})}),h=(0,l.cI)({resolver:(0,i.F)(p),defaultValues:{max_players:10,cost_per_player:5,is_private:!1,venue_confirmed:!1}}),y=Array.from({length:27},(e,a)=>"".concat((Math.floor(a/2)+10).toString().padStart(2,"0"),":").concat(a%2==0?"00":"30")),b=async t=>{try{m(!0);let r=(0,c.createClientComponentClient)(),{data:{user:s}}=await r.auth.getUser();if(!s){a({title:"Error",description:"You must be logged in to create a match",variant:"destructive"});return}let[n,l]=t.match_time.split(":").map(Number),i=new Date(t.match_date);i.setHours(n,l);let o=t.is_private?Math.random().toString(36).substring(2,8).toUpperCase():null,{data:d,error:u}=await r.from("matches").insert({venue_id:t.venue_id,host_id:s.id,match_date:i.toISOString(),max_players:t.max_players,cost_per_player:t.cost_per_player,is_private:t.is_private,private_code:o,status:"upcoming"}).select("\n          *,\n          venue:venues(*)\n        ").single();if(u)throw u;let{error:p}=await r.from("match_participants").insert({match_id:d.id,player_id:s.id});if(p)throw p;t.is_private||await T(d),a({title:"Success",description:"Match created successfully!"}),e.push("/match/".concat(d.id))}catch(e){console.error("Error creating match:",e),a({title:"Error",description:"Failed to create match",variant:"destructive"})}finally{m(!1)}};return(0,r.jsx)("div",{className:"p-4 max-w-2xl mx-auto",children:(0,r.jsxs)(q.Zb,{className:"border-2",children:[(0,r.jsx)(q.Ol,{className:"bg-gradient-to-r from-primary/10 to-transparent",children:(0,r.jsxs)(q.ll,{className:"text-2xl font-bold flex items-center gap-2",children:[(0,r.jsx)(A,{className:"h-6 w-6 text-primary"}),u("create.title")]})}),(0,r.jsx)(q.aY,{className:"p-6",children:(0,r.jsx)(d.l0,{...h,children:(0,r.jsxs)("form",{onSubmit:h.handleSubmit(b),className:"space-y-6",children:[(0,r.jsx)(d.Wi,{control:h.control,name:"venue_id",render:e=>{let{field:a}=e;return(0,r.jsxs)(d.xJ,{children:[(0,r.jsx)(d.lX,{children:u("create.venue.label")}),(0,r.jsxs)(f,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,r.jsx)(d.NI,{children:(0,r.jsx)(j,{children:(0,r.jsx)(g,{placeholder:u("create.venue.placeholder")})})}),(0,r.jsx)(v,{children:(0,r.jsx)(w,{value:"d290f1ee-6c54-4b01-90e6-d701748f0851",children:"Leontes"})})]}),(0,r.jsx)(d.zG,{})]})}}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(d.Wi,{control:h.control,name:"match_date",render:e=>{let{field:a}=e;return(0,r.jsxs)(d.xJ,{className:"flex flex-col",children:[(0,r.jsx)(d.lX,{children:u("create.date.label")}),(0,r.jsxs)(V,{children:[(0,r.jsx)(O,{asChild:!0,children:(0,r.jsx)(d.NI,{children:(0,r.jsxs)(k.z,{variant:"outline",className:(0,x.cn)("pl-3 text-left font-normal",!a.value&&"text-muted-foreground"),children:[a.value?(0,W.ZP)(a.value,"PPP"):(0,r.jsx)("span",{children:u("create.date.placeholder")}),(0,r.jsx)(P.Z,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,r.jsx)(J,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(M,{mode:"single",selected:a.value,onSelect:a.onChange,disabled:e=>e<new Date,initialFocus:!0})})]}),(0,r.jsx)(d.zG,{})]})}}),(0,r.jsx)(d.Wi,{control:h.control,name:"match_time",render:e=>{let{field:a}=e;return(0,r.jsxs)(d.xJ,{children:[(0,r.jsx)(d.lX,{children:u("create.time.label")}),(0,r.jsxs)(f,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,r.jsx)(d.NI,{children:(0,r.jsx)(j,{children:(0,r.jsx)(g,{placeholder:u("create.time.placeholder")})})}),(0,r.jsx)(v,{children:y.map(e=>(0,r.jsx)(w,{value:e,children:e},e))})]}),(0,r.jsx)(d.zG,{})]})}})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(d.Wi,{control:h.control,name:"max_players",render:e=>{let{field:a}=e;return(0,r.jsxs)(d.xJ,{children:[(0,r.jsx)(d.lX,{children:u("create.players.label")}),(0,r.jsxs)(f,{onValueChange:e=>a.onChange(Number(e)),defaultValue:a.value.toString(),children:[(0,r.jsx)(d.NI,{children:(0,r.jsx)(j,{children:(0,r.jsx)(g,{placeholder:u("create.players.label")})})}),(0,r.jsx)(v,{children:[10,12,14,16].map(e=>(0,r.jsxs)(w,{value:e.toString(),children:[e," ",u("create.players.suffix")]},e))})]}),(0,r.jsx)(d.zG,{})]})}}),(0,r.jsx)(d.Wi,{control:h.control,name:"cost_per_player",render:e=>{let{field:a}=e;return(0,r.jsxs)(d.xJ,{children:[(0,r.jsx)(d.lX,{children:u("create.cost.label")}),(0,r.jsx)(d.NI,{children:(0,r.jsx)(C.I,{type:"number",min:"0",step:"0.5",placeholder:u("create.cost.placeholder"),...a,onChange:e=>a.onChange(Number(e.target.value))})}),(0,r.jsx)(d.zG,{})]})}})]}),(0,r.jsx)(d.Wi,{control:h.control,name:"is_private",render:e=>{let{field:a}=e;return(0,r.jsxs)(d.xJ,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(d.lX,{className:"text-base",children:u("create.privateMatch.label")}),(0,r.jsx)(d.pf,{children:u("create.privateMatch.description")})]}),(0,r.jsx)(d.NI,{children:(0,r.jsx)(S.r,{checked:a.value,onCheckedChange:a.onChange})})]})}}),(0,r.jsx)(d.Wi,{control:h.control,name:"venue_confirmed",render:e=>{let{field:a}=e;return(0,r.jsxs)(d.xJ,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[(0,r.jsx)(d.NI,{children:(0,r.jsx)(L,{checked:a.value,onCheckedChange:a.onChange})}),(0,r.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,r.jsx)(d.lX,{className:"text-sm font-medium leading-none",children:u("create.venueConfirmation.label")}),(0,r.jsx)(d.pf,{className:"text-sm text-muted-foreground",children:u("create.venueConfirmation.description")}),(0,r.jsx)(d.zG,{})]})]})}}),(0,r.jsx)(k.z,{type:"submit",className:"w-full bg-primary hover:bg-primary/90 text-white shadow-lg transition-all",disabled:t||!h.watch("venue_confirmed"),children:t?u("create.submit.creating"):u("create.submit.create")})]})})})]})})}}},function(e){e.O(0,[952,157,933,249,705,258,971,864,744],function(){return e(e.s=8010)}),_N_E=e.O()}]);