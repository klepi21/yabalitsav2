(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[323],{8694:(e,a,t)=>{Promise.resolve().then(t.bind(t,7118))},7118:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>D});var r=t(5155),s=t(2115),l=t(6046),n=t(9606),i=t(2679),d=t(3415),o=t(9806),c=t(4839),m=t(3409),u=t(1719),p=t(1902),h=t(8867),x=t(9602);let f=m.bL;m.YJ;let j=m.WT,g=s.forwardRef((e,a)=>{let{className:t,children:s,...l}=e;return(0,r.jsxs)(m.l9,{ref:a,className:(0,x.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...l,children:[s,(0,r.jsx)(m.In,{asChild:!0,children:(0,r.jsx)(u.A,{className:"h-4 w-4 opacity-50"})})]})});g.displayName=m.l9.displayName;let y=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(m.PP,{ref:a,className:(0,x.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})});y.displayName=m.PP.displayName;let b=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(m.wn,{ref:a,className:(0,x.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(u.A,{className:"h-4 w-4"})})});b.displayName=m.wn.displayName;let v=s.forwardRef((e,a)=>{let{className:t,children:s,position:l="popper",...n}=e;return(0,r.jsx)(m.ZL,{children:(0,r.jsxs)(m.UC,{ref:a,className:(0,x.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...n,children:[(0,r.jsx)(y,{}),(0,r.jsx)(m.LM,{className:(0,x.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(b,{})]})})});v.displayName=m.UC.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(m.JU,{ref:a,className:(0,x.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s})}).displayName=m.JU.displayName;let w=s.forwardRef((e,a)=>{let{className:t,children:s,...l}=e;return(0,r.jsxs)(m.q7,{ref:a,className:(0,x.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(m.VF,{children:(0,r.jsx)(h.A,{className:"h-4 w-4"})})}),(0,r.jsx)(m.p4,{children:s})]})});w.displayName=m.q7.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(m.wv,{ref:a,className:(0,x.cn)("-mx-1 my-1 h-px bg-muted",t),...s})}).displayName=m.wv.displayName;var N=t(2336),_=t(4085),C=t(3518),R=t(6967),M=t(830);function k(e){let{className:a,classNames:t,showOutsideDays:s=!0,...l}=e;return(0,r.jsx)(M.hv,{showOutsideDays:s,className:(0,x.cn)("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,x.cn)((0,_.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,x.cn)((0,_.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{...a}=e;return(0,r.jsx)(C.A,{className:"h-4 w-4"})},IconRight:e=>{let{...a}=e;return(0,r.jsx)(R.A,{className:"h-4 w-4"})}},...l})}k.displayName="Calendar";var z=t(2581),I=t(532);let S=I.bL,L=I.l9,J=s.forwardRef((e,a)=>{let{className:t,align:s="center",sideOffset:l=4,...n}=e;return(0,r.jsx)(I.ZL,{children:(0,r.jsx)(I.UC,{ref:a,align:s,sideOffset:l,className:(0,x.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})})});J.displayName=I.UC.displayName;var P=t(2423),V=t(6695),A=t(7072),B=t(32),U=t(241),q=t(5007),E=t(6352);let O=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(E.bL,{ref:a,className:(0,x.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:(0,r.jsx)(E.C1,{className:(0,x.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(h.A,{className:"h-4 w-4"})})})});function Y(e){return(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("path",{d:"M12 2a10 10 0 0 1 8.66 5"}),(0,r.jsx)("path",{d:"M12 2a10 10 0 0 0-8.66 5"}),(0,r.jsx)("path",{d:"M12 22V2"}),(0,r.jsx)("path",{d:"M12 22a10 10 0 0 0 8.66-5"}),(0,r.jsx)("path",{d:"M12 22a10 10 0 0 1-8.66-5"}),(0,r.jsx)("path",{d:"M2 12h20"})]})}O.displayName=E.bL.displayName;var Z=t(3367);function D(){let e=(0,l.useRouter)();(0,o.createClientComponentClient)();let{toast:a}=(0,U.dj)(),[t,m]=(0,s.useState)(!1),{t:u}=(0,Z.o)(),p=d.Ik({venue_id:d.Yj({required_error:u("create.errors.venueRequired")}),match_date:d.p6({required_error:u("create.errors.dateRequired")}).refine(e=>!(0,V.Y)(e,(0,A.R)()),u("create.errors.dateInPast")),match_time:d.Yj().refine(e=>{let[a,t]=e.split(":").map(Number);return a>=10&&a<=23&&(0===t||30===t)},u("create.errors.timeInvalid")),max_players:d.ai().min(10,u("create.errors.playersRange")).max(16,u("create.errors.playersRange")),cost_per_player:d.ai().min(0,u("create.errors.costNegative")),is_private:d.zM().default(!1),venue_confirmed:d.zM().refine(e=>!0===e,{message:u("create.errors.venueConfirmRequired")})}),h=(0,n.mN)({resolver:(0,i.u)(p),defaultValues:{max_players:10,cost_per_player:5,is_private:!1,venue_confirmed:!1}}),y=Array.from({length:27},(e,a)=>{let t=Math.floor(a/2)+10;return"".concat(t.toString().padStart(2,"0"),":").concat(a%2==0?"00":"30")}),b=async t=>{try{m(!0);let r=(0,o.createClientComponentClient)(),{data:{user:s}}=await r.auth.getUser();if(!s){a({title:"Error",description:"You must be logged in to create a match",variant:"destructive"});return}let[l,n]=t.match_time.split(":").map(Number),i=new Date(t.match_date);i.setHours(l,n);let d=t.is_private?Math.random().toString(36).substring(2,8).toUpperCase():null,{data:c,error:u}=await r.from("matches").insert({venue_id:t.venue_id,host_id:s.id,match_date:i.toISOString(),max_players:t.max_players,cost_per_player:t.cost_per_player,is_private:t.is_private,private_code:d,status:"upcoming"}).select().single();if(u)throw u;let{error:p}=await r.from("match_participants").insert({match_id:c.id,player_id:s.id});if(p)throw p;a({title:"Success",description:"Match created successfully!"}),e.push("/match/".concat(c.id))}catch(e){console.error("Error creating match:",e),a({title:"Error",description:"Failed to create match",variant:"destructive"})}finally{m(!1)}};return(0,r.jsx)("div",{className:"p-4 max-w-2xl mx-auto",children:(0,r.jsxs)(q.Zp,{className:"border-2",children:[(0,r.jsx)(q.aR,{className:"bg-gradient-to-r from-primary/10 to-transparent",children:(0,r.jsxs)(q.ZB,{className:"text-2xl font-bold flex items-center gap-2",children:[(0,r.jsx)(Y,{className:"h-6 w-6 text-primary"}),u("create.title")]})}),(0,r.jsx)(q.Wu,{className:"p-6",children:(0,r.jsx)(c.lV,{...h,children:(0,r.jsxs)("form",{onSubmit:h.handleSubmit(b),className:"space-y-6",children:[(0,r.jsx)(c.zB,{control:h.control,name:"venue_id",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:u("create.venue.label")}),(0,r.jsxs)(f,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,r.jsx)(c.MJ,{children:(0,r.jsx)(g,{children:(0,r.jsx)(j,{placeholder:u("create.venue.placeholder")})})}),(0,r.jsx)(v,{children:(0,r.jsx)(w,{value:"d290f1ee-6c54-4b01-90e6-d701748f0851",children:"Leontes"})})]}),(0,r.jsx)(c.C5,{})]})}}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(c.zB,{control:h.control,name:"match_date",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{className:"flex flex-col",children:[(0,r.jsx)(c.lR,{children:u("create.date.label")}),(0,r.jsxs)(S,{children:[(0,r.jsx)(L,{asChild:!0,children:(0,r.jsx)(c.MJ,{children:(0,r.jsxs)(_.$,{variant:"outline",className:(0,x.cn)("pl-3 text-left font-normal",!a.value&&"text-muted-foreground"),children:[a.value?(0,B.GP)(a.value,"PPP"):(0,r.jsx)("span",{children:u("create.date.placeholder")}),(0,r.jsx)(P.A,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,r.jsx)(J,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(k,{mode:"single",selected:a.value,onSelect:a.onChange,disabled:e=>e<new Date,initialFocus:!0})})]}),(0,r.jsx)(c.C5,{})]})}}),(0,r.jsx)(c.zB,{control:h.control,name:"match_time",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:u("create.time.label")}),(0,r.jsxs)(f,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,r.jsx)(c.MJ,{children:(0,r.jsx)(g,{children:(0,r.jsx)(j,{placeholder:u("create.time.placeholder")})})}),(0,r.jsx)(v,{children:y.map(e=>(0,r.jsx)(w,{value:e,children:e},e))})]}),(0,r.jsx)(c.C5,{})]})}})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(c.zB,{control:h.control,name:"max_players",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:u("create.players.label")}),(0,r.jsxs)(f,{onValueChange:e=>a.onChange(Number(e)),defaultValue:a.value.toString(),children:[(0,r.jsx)(c.MJ,{children:(0,r.jsx)(g,{children:(0,r.jsx)(j,{placeholder:u("create.players.label")})})}),(0,r.jsx)(v,{children:[10,12,14,16].map(e=>(0,r.jsxs)(w,{value:e.toString(),children:[e," ",u("create.players.suffix")]},e))})]}),(0,r.jsx)(c.C5,{})]})}}),(0,r.jsx)(c.zB,{control:h.control,name:"cost_per_player",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:u("create.cost.label")}),(0,r.jsx)(c.MJ,{children:(0,r.jsx)(N.p,{type:"number",min:"0",step:"0.5",placeholder:u("create.cost.placeholder"),...a,onChange:e=>a.onChange(Number(e.target.value))})}),(0,r.jsx)(c.C5,{})]})}})]}),(0,r.jsx)(c.zB,{control:h.control,name:"is_private",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(c.lR,{className:"text-base",children:u("create.privateMatch.label")}),(0,r.jsx)(c.Rr,{children:u("create.privateMatch.description")})]}),(0,r.jsx)(c.MJ,{children:(0,r.jsx)(z.d,{checked:a.value,onCheckedChange:a.onChange})})]})}}),(0,r.jsx)(c.zB,{control:h.control,name:"venue_confirmed",render:e=>{let{field:a}=e;return(0,r.jsxs)(c.eI,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[(0,r.jsx)(c.MJ,{children:(0,r.jsx)(O,{checked:a.value,onCheckedChange:a.onChange})}),(0,r.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,r.jsx)(c.lR,{className:"text-sm font-medium leading-none",children:u("create.venueConfirmation.label")}),(0,r.jsx)(c.Rr,{className:"text-sm text-muted-foreground",children:u("create.venueConfirmation.description")}),(0,r.jsx)(c.C5,{})]})]})}}),(0,r.jsx)(_.$,{type:"submit",className:"w-full bg-primary hover:bg-primary/90 text-white shadow-lg transition-all",disabled:t||!h.watch("venue_confirmed"),children:t?u("create.submit.creating"):u("create.submit.create")})]})})})]})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[184,867,348,119,667,145,441,517,358],()=>a(8694)),_N_E=e.O()}]);