(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811],{5913:function(e,t,s){Promise.resolve().then(s.bind(s,4247))},4247:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var a=s(7437),i=s(9853),r=s(2265),n=s(2243),c=s(9311);let l=n.fC,o=r.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)(n.aV,{ref:t,className:(0,c.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...i})});o.displayName=n.aV.displayName;let d=r.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)(n.xz,{ref:t,className:(0,c.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...i})});d.displayName=n.xz.displayName;let m=r.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)(n.VY,{ref:t,className:(0,c.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...i})});m.displayName=n.VY.displayName;var u=s(4566);let h="https://uinmrgrmqhgonrshidcy.supabase.co",p="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVpbm1yZ3JtcWhnb25yc2hpZGN5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ1MTIyMzUsImV4cCI6MjA1MDA4ODIzNX0.TtAI51MHBOVQUCd7hH-FTIOdERFjIBMIg7FussygnKk";if(!h||!p)throw Error("Missing Supabase environment variables");let x=(0,u.eI)(h,p,{auth:{persistSession:!0,autoRefreshToken:!0}});function f(e){let[t,s]=(0,r.useState)([]),[a,i]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let t=async()=>{try{let t=x.from("matches").select("\n            *,\n            venue:venues(*),\n            host:profiles(*),\n            participants:match_participants(\n              player:profiles(*)\n            )\n          ").order("match_date",{ascending:!0});e&&t.eq("status",e);let{data:a,error:i}=await t;if(i)throw i;s(a||[])}catch(e){console.error("Error fetching matches:",e)}finally{i(!1)}};t();let a=x.channel("matches").on("postgres_changes",{event:"*",schema:"public",table:"matches"},()=>{t()}).subscribe();return()=>{a.unsubscribe()}},[e]),{matches:t,loading:a}}var v=s(6085);function g(){let{t:e}=(0,i.useLanguage)(),{matches:t,loading:s}=f("finished"),{matches:r,loading:n}=f("upcoming");return(0,a.jsxs)("div",{className:"p-4 space-y-6",children:[(0,a.jsx)("header",{className:"flex items-center justify-between mb-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:e("history.title")}),(0,a.jsx)("p",{className:"text-muted-foreground",children:e("history.subtitle")})]})}),(0,a.jsxs)(l,{defaultValue:"upcoming",children:[(0,a.jsxs)(o,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(d,{value:"upcoming",children:e("history.tabs.upcoming")}),(0,a.jsx)(d,{value:"finished",children:e("history.tabs.finished")})]}),(0,a.jsx)(m,{value:"upcoming",children:0===r.length?(0,a.jsx)("p",{className:"text-center text-muted-foreground py-8",children:e("history.noMatches")}):(0,a.jsx)("div",{className:"space-y-4",children:r.map(e=>{var t;return(0,a.jsx)(v.m,{match:{...e,participants:null===(t=e.participants)||void 0===t?void 0:t.map(e=>({player:{id:e.id,full_name:e.full_name}}))}},e.id)})})}),(0,a.jsx)(m,{value:"finished",children:0===t.length?(0,a.jsx)("p",{className:"text-center text-muted-foreground py-8",children:e("history.noMatches")}):(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>{var t;return(0,a.jsx)(v.m,{match:{...e,participants:null===(t=e.participants)||void 0===t?void 0:t.map(e=>({player:{id:e.id,full_name:e.full_name}}))}},e.id)})})})]})]})}},6085:function(e,t,s){"use strict";s.d(t,{m:function(){return y}});var a=s(7437),i=s(9314),r=s(5750),n=s(6141),c=s(6224),l=s(9764),o=s(9581),d=s(3023),m=s(6110),u=s(9155),h=s(3082),p=s(2265),x=s(2621),f=s(4033),v=s(9853),g=s(1213),b=s(9311);let j=async e=>{try{return await navigator.clipboard.writeText(e),!0}catch(e){return console.error("Failed to copy text: ",e),!1}};function y(e){var t,s,y;let{match:N}=e,{t:_}=(0,v.useLanguage)(),[w,I]=(0,p.useState)(!1),[C,k]=(0,p.useState)(!1),[E,M]=(0,p.useState)(!1),z=(0,h.createClientComponentClient)(),{toast:S}=(0,x.pm)(),Z=(0,f.useRouter)(),[J,O]=(0,p.useState)(!1),V=new Date(N.match_date),F=(0,g.x)(V,"EEEE d MMM"),R=(0,i.ZP)(V,"HH:mm"),P=(null===(t=N.participants)||void 0===t?void 0:t.length)||0;(0,p.useEffect)(()=>{let e=async()=>{var e;let{data:{user:t}}=await z.auth.getUser();t&&(k(N.host_id===t.id),I((null===(e=N.participants)||void 0===e?void 0:e.some(e=>e.player.id===t.id))||!1))};e()},[N.host_id,N.participants]);let Y=async e=>{try{e.stopPropagation(),M(!0);let{data:{user:t}}=await z.auth.getUser();if(!t)return;if(N.is_private){Z.push("/match/".concat(N.id));return}let{error:s}=await z.from("match_participants").insert({match_id:N.id,player_id:t.id});if(s)throw s;I(!0),S({title:"Success",description:"You've joined the match!"})}catch(e){console.error("Error joining match:",e),S({title:"Error",description:"Failed to join match",variant:"destructive"})}finally{M(!1)}};return(0,a.jsxs)(m.Zb,{className:"cursor-pointer transition-all hover:bg-accent/50 hover:scale-[1.02] border-2  shadow-[0_0_15px_rgba(0,0,0,0.1)] dark:shadow-[0_0_15px_rgba(255,255,255,0.1)] hover:shadow-[0_0_20px_rgba(0,0,0,0.15)] dark:hover:shadow-[0_0_20px_rgba(255,255,255,0.15)] bg-card/50 backdrop-blur-sm",onClick:()=>Z.push("/match/".concat(N.id)),children:[(0,a.jsxs)(m.Ol,{className:"flex flex-row items-center justify-between pb-2  bg-gradient-to-r from-primary/20 via-primary/10 to-transparent  border-b border-border/50",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:null===(s=N.venue)||void 0===s?void 0:s.name}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,a.jsx)(r.Z,{className:"h-3 w-3"}),_("matches.host")," ",(0,b.K)(null===(y=N.host)||void 0===y?void 0:y.full_name)]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[N.is_private&&(0,a.jsx)(u.C,{variant:"secondary",children:_("matches.private")}),P>=N.max_players?(0,a.jsx)(u.C,{variant:"destructive",children:_("matches.full")}):(0,a.jsx)(u.C,{variant:"outline",children:_("matches.status.".concat(N.status))})]})]}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(n.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{children:F})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(n.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{children:R})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(o.R,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("span",{children:["â‚¬",N.cost_per_player]})]})]}),(0,a.jsxs)("div",{className:"pt-3 border-t",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:_("matches.players")}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground ml-2",children:["(",(0,b.T)(N.max_players),")"]})]}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[P," / ",N.max_players]})]}),(0,a.jsx)("div",{className:"relative h-2 bg-secondary rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 bg-primary transition-all",style:{width:"".concat(P/N.max_players*100,"%")}})})]}),!C&&!w&&P<N.max_players&&"upcoming"===N.status&&(0,a.jsx)(d.z,{className:"w-full mt-2 bg-primary hover:bg-primary/90 text-white shadow-lg",variant:"default",disabled:E,onClick:Y,children:_(N.is_private?"matches.details.joinPrivate":"matches.join")}),C&&N.is_private&&(0,a.jsxs)("div",{className:"mt-2 p-3 bg-muted rounded-lg space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"Private Match Code"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(d.z,{size:"sm",variant:"outline",className:"h-7",onClick:async e=>{if(e.stopPropagation(),!N.private_code)return;let t=await j(N.private_code);t?S({title:"Copied!",description:"Match code copied to clipboard",duration:2e3}):S({title:"Error",description:"Failed to copy code",variant:"destructive"})},children:[(0,a.jsx)(c.Z,{className:"h-3 w-3 mr-1"}),"Copy"]}),(0,a.jsxs)(d.z,{size:"sm",variant:"outline",className:"h-7",onClick:e=>{if(e.stopPropagation(),N.private_code){if(navigator.share){var t;navigator.share({title:"Join my football match!",text:"Join my match at ".concat(null===(t=N.venue)||void 0===t?void 0:t.name,"! Use code: ").concat(N.private_code),url:window.location.href}).catch(e=>{console.error("Error sharing:",e)})}else S({title:"Sharing not supported",description:"Your browser doesn't support sharing",variant:"destructive"})}},children:[(0,a.jsx)(l.Z,{className:"h-3 w-3 mr-1"}),"Share"]})]})]}),(0,a.jsx)("p",{className:"text-base font-mono tracking-wider text-center bg-background rounded p-1",children:N.private_code})]})]})]})}}},function(e){e.O(0,[952,651,490,684,971,864,744],function(){return e(e.s=5913)}),_N_E=e.O()}]);